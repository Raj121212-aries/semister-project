
{% extends "layout.html" %}
{% block content %}
<h2>Complaints</h2>

{% if role == "student" %}
  <form method="post" class="grid">
    <textarea name="description" rows="3" placeholder="Write your complaint..." required></textarea>
    <button class="button" type="submit">Submit</button>
  </form>
{% endif %}

<table class="table">
  <tr><th>ID</th><th>Student</th><th>Description</th><th>Status</th><th>Reply</th>{% if role == "warden" %}<th>Action</th>{% endif %}</tr>
  {% for c in complaints %}
    <tr>
      <td>{{ c['id'] }}</td>
      <td>{{ c['student_name'] }}</td>
      <td>{{ c['description'] }}</td>
      <td><span class="badge">{{ c['status'] }}</span></td>
      <td>{{ c['reply'] or 'â€”' }}</td>
      {% if role == "warden" %}
      <td>
        <form method="post" class="grid">
          <input type="hidden" name="complaint_id" value="{{ c['id'] }}">
          <textarea name="reply" rows="2" placeholder="Reply..."></textarea>
          <button class="button" name="action" value="close">Close</button>
        </form>
      </td>
      {% endif %}
    </tr>
  {% endfor %}
</table>
{% endblock %}
